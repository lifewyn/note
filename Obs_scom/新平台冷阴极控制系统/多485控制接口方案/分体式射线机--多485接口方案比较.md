---
time: 2025-03-26
tags:
  - scom
---
### 在新平台上对射线机需要2个串口控制，可以采用两种方案：  
（1）通过一个串口挂载2个串口设备；  
（2）分别通过两个独立串口接口控制。

### 一、**软件设计对比**
| **特性**   | **方案 1（单接口多设备）**   | **方案 2（多接口单设备）**   |
| -------- | ------------------ | ------------------ |
| **时序控制** | 比较复杂，需要严格控制时序，避免冲突 | 简单，每个接口独立控制，无需担心冲突 |
| **冲突检测** | 需要实现冲突检测机制         | 无需冲突检测机制           |
| **调试难度** | 调试比较复杂，容易受到其他设备干扰  | 调试简单，每个接口独立调试      |
| **硬件要求** | 单个 485 接口，硬件成本低    | 需要两个 485 接口，硬件成本高  |

### 四、**软件测试结果**
#### 1.测试两个串口订阅同一主题接收时间戳测试：
![[Pasted image 20250327142343.png]]
#### 2.测试除第一个条件上，添加另一个定时发布订阅的led处理，测试串口接收时间戳测试：
![[Pasted image 20250327142529.png]]
#### 3.测试除第一二条件上，添加多个订阅者订阅串口相同的测试主题，测试串口接收时间戳测试
![[Pasted image 20250327142428.png]]
#### 总结：
统计的三种工况，两者的时间都是同步的，
最大的时间戳相差15ms，应该不会影响功能。

### 五、推荐方案

使用两个独立的 485 接口分别连接两个设备的方案：
- **时序控制**更加简单，无需考虑设备之间的冲突。
- **调试**更加方便，可以独立监控每个接口的通信状态。
- **并行处理能力**更强，可以同时对两个设备进行操作。
- **设备管理**更加简单，无需管理设备地址。
